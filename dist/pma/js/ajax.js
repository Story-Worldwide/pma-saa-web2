function GetXmlHttpObject(e){var t=null;if(navigator.userAgent.indexOf("MSIE")>=0){var n="Msxml2.XMLHTTP";try{t=new ActiveXObject(n),t.onreadystatechange=e}catch(l){try{n="Microsoft.XMLHTTP",t=new ActiveXObject(n),t.onreadystatechange=e}catch(o){t=!1}}}else"undefined"!=typeof XMLHttpRequest?(t=new XMLHttpRequest,t.onload=e,t.onerror=e):t=!1;return t}function folkStateChanged(){xmlHttp&&(4!=xmlHttp.readyState&&"complete"!=xmlHttp.readyState||(document.getElementById("folksonomy").innerHTML=xmlHttp.responseText))}function addFolkData(){var e=document.forms.form2,t=e.elements.ObjectID.value,n=e.elements.req_userInput.value;if(!(n.indexOf("http://")<0&&t.length>0&&n.length>0&&GetXmlHttpObject(folkStateChanged)))return n.indexOf("http://")>=0?(alert("Please do not enter URLs."),e.elements.req_userInput.select()):(alert("Please enter a tag."),e.elements.req_userInput.focus()),!1;var l="/collections/folksonomy_ajax.php?ObjectID="+t+"&req_userInput="+n;xmlHttp=GetXmlHttpObject(folkStateChanged),xmlHttp.open("GET",l,!0),xmlHttp.send(null)}function delFolkData(e,t){var n=document.forms.form2,l=n.elements.ObjectID.value;if(l.length>0&&GetXmlHttpObject(folkStateChanged)&&confirm("Are you sure you want to delete this?")){var o="/collections/folksonomy_ajax.php?tagID="+e+"&objID="+t;xmlHttp=GetXmlHttpObject(folkStateChanged),xmlHttp.open("GET",o,!0),xmlHttp.send(null)}}function forumStateChanged(){xmlHttp&&(4!=xmlHttp.readyState&&"complete"!=xmlHttp.readyState||(document.getElementById(curRead).style.display="none",curRead=null))}function updateForumData(e){if(e=e.toString(),e.length>0&&GetXmlHttpObject(forumStateChanged)){curRead="read"+e;var t="forums_ajax.php?id="+e;xmlHttp=GetXmlHttpObject(forumStateChanged),xmlHttp.open("GET",t,!0),xmlHttp.send(null)}}function stateChanged(){xmlHttp&&(4!=xmlHttp.readyState&&"complete"!=xmlHttp.readyState||(document.getElementById("suggestions").innerHTML=xmlHttp.responseText,xmlHttp.responseText.length>0&&1==document.forms[0].elements.bSuggest.value?(mouseHighlight(0),document.getElementById("suggestions").style.display=""):document.getElementById("suggestions").style.display="none"))}function letterStateChanged(){xmlHttp&&(4!=xmlHttp.readyState&&"complete"!=xmlHttp.readyState||(document.getElementById("artistMaker").innerHTML=xmlHttp.responseText))}function myCalStateChanged(){xmlHttp&&(4!=xmlHttp.readyState&&"complete"!=xmlHttp.readyState||(null!=curExDiv&&(document.getElementById(curExDiv).innerHTML="[<span class='note'><a href='/myMuseum/mycalendar.html'>Saved</a></span>]",curExDiv=null),document.getElementById("verify").innerHTML=xmlHttp.responseText))}function getData(e,t){var n=null;if(null!=t&&(n=getKeyCode(t)),38==n||40==n)keyHighlight(t);else if(e.value.length>0&&GetXmlHttpObject(stateChanged)){var l="getSuggestions.php?searchTxt="+e.value;xmlHttp=GetXmlHttpObject(stateChanged),xmlHttp.open("GET",l,!0),xmlHttp.send(null)}else document.getElementById("suggestions").innerHTML="",document.getElementById("suggestions").style.display="none"}function getLetterData(e){if(e.length>0&&GetXmlHttpObject(letterStateChanged)){var t="getArtistMaker.php?letter="+e;xmlHttp=GetXmlHttpObject(letterStateChanged),xmlHttp.open("GET",t,!0),xmlHttp.send(null)}}function addToCalendar(e){if(e>0&&GetXmlHttpObject(myCalStateChanged)){curExDiv="exDiv_"+e;var t="addToCalendar.php?exID="+e;xmlHttp=GetXmlHttpObject(myCalStateChanged),xmlHttp.open("GET",t,!0),xmlHttp.send(null)}}function replaceKeywords(e){null!=e&&e.indexOf("\\")>=0&&e.replace("\\",""),null!=e?document.forms[0].elements.searchTxt.value=e:(document.getElementById("opt"+curSelected)||0==curSelected)&&(document.forms[0].elements.searchTxt.value=document.getElementById("opt"+curSelected).innerHTML),"none"!=document.getElementById("suggestions").style.display&&(document.getElementById("suggestions").style.display="none",document.forms[0].submit())}function keySelect(e){var t=getKeyCode(e);13==t&&replaceKeywords(null)}function hideSuggestions(){document.getElementById("suggestions").style.display="none"}function toggleSuggestions(){1==document.forms[0].elements.bSuggest.value?(document.getElementById("optionsTxt").innerHTML=' [ <a href="javascript:toggleSuggestions();">Hints Off</a> ] ',hideSuggestions(),document.forms[0].elements.bSuggest.value=0):(document.getElementById("optionsTxt").innerHTML=' [ <a href="javascript:toggleSuggestions();">Hints On</a> ] ',getData(document.forms[0].elements.searchTxt),document.forms[0].elements.bSuggest.value=1)}function mouseDeselect(){0==curSelected&&curSelected==maxRecs||!document.getElementById("opt"+curSelected)||(prevObj=document.getElementById("opt"+curSelected).style,curObj=null,changeBG(prevObj,curObj))}function mouseHighlight(e){if(e>0){var t=null,n=document.getElementById("opt"+e).style;t=document.getElementById("opt"+curSelected)?document.getElementById("opt"+curSelected).style:null,t==n&&(t=null),changeBG(t,n)}curSelected=e,firstTime=1}function getKeyCode(e){var t=null;if(!e)var e=window.event;return e.keyCode?t=e.keyCode:e.charCode&&(t=e.charCode),t}function keyHighlight(e){getMax();var t=getKeyCode(e),n=curSelected,l="",o="";38==t?(curSelected>maxRecs?(curSelected=maxRecs,n=curSelected):n=curSelected-1,n<0&&(n=0),n==maxRecs?(o=null,l=document.getElementById("opt"+n).style):n>0?(document.getElementById("opt"+curSelected)&&(o=document.getElementById("opt"+curSelected).style),l=document.getElementById("opt"+n).style):(o=curSelected>0?document.getElementById("opt"+curSelected).style:document.getElementById("opt1").style,l=document.getElementById("opt1").style,o==l&&(l=null))):40==t?(n=curSelected+1,document.getElementById("opt"+n)?(o=curSelected>0?document.getElementById("opt"+curSelected).style:document.getElementById("opt"+maxRecs)&&1!=maxRecs?document.getElementById("opt"+maxRecs).style:null,l=document.getElementById("opt"+n).style,o==l&&(l=null)):(n--,document.getElementById("opt"+n)&&(o=document.getElementById("opt"+n).style,l=null,n++))):0==firstTime&&(o=null,l=null),40!=t&&38!=t||(changeBG(o,l),curSelected=n),firstTime=1,navigator.userAgent.indexOf("MSIE")<0&&e.stopPropagation()}function changeBG(e,t){navigator.userAgent.indexOf("MSIE")<0?(null!=e&&(e.backgroundColor="rgb(255,255,255)",e.color="rgb(76,76,76)"),t&&(t.backgroundColor="rgb(0,0,102)",t.color="rgb(255,255,255)")):(null!=e&&(e.backgroundColor="#FFFFFF",e.color="#4c4c4c"),t&&(t.backgroundColor="#000066",t.color="#FFFFFF"))}function getMax(){var e=1,t=document.getElementById("opt"+e);do e++,t=document.getElementById("opt"+e);while(t);maxRecs=e-1}function objVoteChanged(){xmlHttp&&(4!=xmlHttp.readyState&&"complete"!=xmlHttp.readyState||(document.getElementById("votes").innerHTML=xmlHttp.responseText))}function addObjVote(){document.getElementById("myButton").style.display="none";var e=document.forms.voteForm,t=e.elements.objectid.value,n=e.elements.objvoterid.value;if(ga("send","event","Liked It","object liked",t),!(t>0&&GetXmlHttpObject(objVoteChanged)))return!1;var l="/collections/objectVote_ajax.php?objectid="+t+"&objvoterid="+n;xmlHttp=GetXmlHttpObject(objVoteChanged),xmlHttp.open("GET",l,!0),xmlHttp.send(null)}var xmlHttp,curRead=null,curExDiv=null,curSelected=0,firstTime=0,maxRecs=7,numRecs=0;